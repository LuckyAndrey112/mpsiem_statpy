Функционал скрипта:
1)Главным функционалом скрипта является построение статистической таблицы Excel, в столбцах которой указаны поля event_src.vendor и 
event_src.hostname, в строках EPS для каждого указанного источника с инервалом в 1 час за указанный absolute_time.
2)Для каждого hostname и каждого временного промежутка при помощи формул Excel считается среднее и максимальное значение EPS
3)По полученным значением на странице "Диаграмма" строится диаграмма с распределение EPS по времени
4)Так как в MP SIEM токен существует 86400 секунд, скрипт автоматически запрашивает новый токен по его истечению
5)Скрипт приводит к удобочитаемому виду агрегационный группы, при которых одинаковые hostname,
связанные с Microsoft имеют разных вендоров (SCeCLi,Eventlog,ESENT), а также агрегирует строчные и прописные hostname
6)Скрытый ввод чувствительных данных (пароль, токен, секрет)

Функции модулей:
args_parser - позволяет при помощи ключей управлять кредами подключения
class_token - получает автоматически токен по заданным кредам, если старого нет или истек
classmp_request - собирает параметры запроса к MP в классе, и при вызове самого объекта класса через call делает запрос, потом немного обрабатывает полученный json
time_mp_siem - подготавливает список timestamp-ов в секундах с интервалом в один час, по которому потом производятся запросы для статистики каждый час
main.py - тут класс который собирает итоговую таблицу из запросов и запускает отрисовку эксельки
FCK_cruth - приводит в порядок кривые агрегации, при которых одинаковые hostname раскиданы по разным вендорам, а также агрегирует строчные и прописные hostname
styles - отрисовывает таблицу exel и диаграмму eps

Инструкция по применению:
для получения справки по ключам запустить
mp_stat.exe -h
для запуска скрипта:
mp_stat.exe -t 7 -u siem.ru
где 7 - время в днях для проведения сканирования, можно задавать дробное, но число должно быть делителем 24 (т.е 7.125, 7.75 - корректно, 7.234 - нет)
siem.ru - Url(или ip) для подключения к ElasticSearch MPSIEM, без HTTPS:// !!!
С узла, откуда идет сбор статистики должен быть доступен компонент SIEM Storage на Elasticsearch
